<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'unsafe-inline'; connect-src https://polygon-rpc.com https://rpc.ankr.com/polygon http://localhost:*; img-src 'none'; form-action 'none'; base-uri 'self';">
<title>GuavaGuard ASI Edition ‚Äî Activate</title>
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #12121a;
    --border: #1e1e2e;
    --primary: #00ff88;
    --primary-dim: #00cc6a;
    --danger: #ff4466;
    --text: #e0e0e0;
    --text-dim: #888;
    --guava: #f4a460;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .container {
    max-width: 520px;
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 40px;
    box-shadow: 0 0 60px rgba(0, 255, 136, 0.05);
  }
  .logo { text-align: center; font-size: 48px; margin-bottom: 8px; }
  h1 {
    text-align: center;
    font-size: 20px;
    color: var(--primary);
    margin-bottom: 4px;
    letter-spacing: 2px;
  }
  .subtitle {
    text-align: center;
    color: var(--text-dim);
    font-size: 12px;
    margin-bottom: 12px;
  }
  .security-banner {
    text-align: center;
    font-size: 10px;
    color: var(--text-dim);
    background: rgba(0,255,136,0.03);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px;
    margin-bottom: 24px;
    line-height: 1.6;
  }
  .security-banner strong { color: var(--primary); }
  .contract-info {
    font-size: 10px;
    color: var(--text-dim);
    background: rgba(244,164,96,0.05);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 20px;
    word-break: break-all;
    line-height: 1.8;
  }
  .contract-info code { color: var(--guava); }
  .step {
    background: rgba(0,255,136,0.03);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 16px;
    transition: border-color 0.3s;
  }
  .step.active { border-color: var(--primary); }
  .step.done { border-color: var(--primary-dim); opacity: 0.6; }
  .step-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
  }
  .step-num {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 13px;
    font-weight: bold;
    color: var(--text-dim);
  }
  .step.active .step-num { background: var(--primary); color: var(--bg); }
  .step.done .step-num { background: var(--primary-dim); color: var(--bg); }
  .step-title { font-size: 14px; font-weight: 600; }
  .step-desc { font-size: 12px; color: var(--text-dim); line-height: 1.6; }
  .input-group { margin-top: 12px; }
  .input-group label {
    display: block;
    font-size: 11px;
    color: var(--text-dim);
    margin-bottom: 4px;
  }
  .input-group input {
    width: 100%;
    padding: 10px 12px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: inherit;
    font-size: 13px;
    outline: none;
  }
  .input-group input:focus { border-color: var(--primary); }
  button.action-btn {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 10px;
    font-family: inherit;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    margin-top: 12px;
    letter-spacing: 1px;
  }
  button.action-btn:disabled { opacity: 0.4; cursor: not-allowed; }
  .btn-connect {
    background: linear-gradient(135deg, #6366f1, #8b5cf6);
    color: #fff;
  }
  .btn-connect:hover:not(:disabled) { filter: brightness(1.1); }
  .btn-approve {
    background: linear-gradient(135deg, var(--guava), #e08830);
    color: var(--bg);
  }
  .btn-approve:hover:not(:disabled) { filter: brightness(1.1); }
  .btn-register {
    background: linear-gradient(135deg, var(--primary), #00cc6a);
    color: var(--bg);
  }
  .btn-register:hover:not(:disabled) { filter: brightness(1.1); }
  .status {
    text-align: center;
    font-size: 12px;
    padding: 8px;
    margin-top: 8px;
    border-radius: 8px;
    display: none;
  }
  .status.info { color: var(--primary); background: rgba(0,255,136,0.05); display: block; }
  .status.error { color: var(--danger); background: rgba(255,68,102,0.05); display: block; }
  .status.success { color: var(--primary); background: rgba(0,255,136,0.1); display: block; }
  .wallet-info {
    font-size: 11px;
    color: var(--text-dim);
    text-align: center;
    margin-top: 4px;
    word-break: break-all;
  }
  .footer {
    text-align: center;
    margin-top: 24px;
    font-size: 11px;
    color: var(--text-dim);
    line-height: 1.8;
  }
  .footer a { color: var(--primary); text-decoration: none; }
  .cost-badge {
    display: inline-block;
    background: rgba(244,164,96,0.15);
    color: var(--guava);
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
  }
  .success-box {
    text-align: center;
    padding: 30px 20px;
    display: none;
  }
  .success-box .emoji { font-size: 64px; margin-bottom: 12px; }
  .success-box h2 { color: var(--primary); font-size: 18px; margin-bottom: 8px; }
  .success-box p { color: var(--text-dim); font-size: 12px; line-height: 1.6; }
  .success-box .tx-link {
    display: block;
    margin-top: 12px;
    color: var(--primary);
    font-size: 11px;
    word-break: break-all;
  }
  .no-wallet-warning {
    display: none;
    text-align: center;
    padding: 20px;
    color: var(--danger);
    font-size: 12px;
    border: 1px solid var(--danger);
    border-radius: 8px;
    margin-bottom: 16px;
  }
</style>
</head>
<body>

<div class="container">
  <!-- Main Flow -->
  <div id="main-flow">
    <div class="logo">üçàüõ°Ô∏è</div>
    <h1>GUAVAGUARD ASI EDITION</h1>
    <div class="subtitle">On-chain soul verification powered by $GUAVA</div>

    <!-- Security Banner -->
    <div class="security-banner">
      üîí <strong>Security Notice</strong><br>
      This page runs entirely in your browser. No backend, no tracking, no cookies.<br>
      Verify the URL and contract addresses below before proceeding.
    </div>

    <!-- Contract Info (Read-Only, always visible) -->
    <div class="contract-info">
      üìã <strong>Contracts (Polygon Mainnet):</strong><br>
      SoulRegistry V2: <code>0xecfa4e769050649aeedf727193690a696f65c3fc</code>
      <a href="https://polygonscan.com/address/0xecfa4e769050649aeedf727193690a696f65c3fc" target="_blank" rel="noopener noreferrer" style="color:var(--primary);font-size:10px;">‚Üó Verify</a><br>
      $GUAVA Token: <code>0x25cBD481901990bF0ed2ff9c5F3C0d4f743AC7B8</code>
      <a href="https://polygonscan.com/address/0x25cBD481901990bF0ed2ff9c5F3C0d4f743AC7B8" target="_blank" rel="noopener noreferrer" style="color:var(--primary);font-size:10px;">‚Üó Verify</a><br>
      Cost: <strong>1,000 $GUAVA</strong> (permanently locked, not burned)
    </div>

    <!-- No Wallet Warning -->
    <div class="no-wallet-warning" id="no-wallet-warning">
      ‚ö†Ô∏è No wallet detected. Please install <a href="https://phantom.app" target="_blank" rel="noopener noreferrer" style="color:var(--danger)">Phantom</a> or <a href="https://metamask.io" target="_blank" rel="noopener noreferrer" style="color:var(--danger)">MetaMask</a> and reload this page.
    </div>

    <!-- Step 1: Connect Wallet -->
    <div class="step active" id="step1">
      <div class="step-header">
        <div class="step-num">1</div>
        <div class="step-title">Connect Wallet</div>
      </div>
      <div class="step-desc">
        Connect your Phantom or MetaMask wallet on <strong>Polygon</strong> network.
      </div>
      <button class="action-btn btn-connect" id="btn-connect">
        Connect Wallet
      </button>
      <div class="wallet-info" id="wallet-info"></div>
    </div>

    <!-- Step 2: Approve $GUAVA -->
    <div class="step" id="step2">
      <div class="step-header">
        <div class="step-num">2</div>
        <div class="step-title">Approve $GUAVA <span class="cost-badge">1,000 $GUAVA</span></div>
      </div>
      <div class="step-desc">
        Approve <strong>exactly</strong> 1,000 $GUAVA to the SoulRegistry. This is NOT unlimited approval ‚Äî
        only the registration amount is approved.
      </div>
      <button class="action-btn btn-approve" id="btn-approve" disabled>
        Approve 1,000 $GUAVA
      </button>
    </div>

    <!-- Step 3: Register Soul -->
    <div class="step" id="step3">
      <div class="step-header">
        <div class="step-num">3</div>
        <div class="step-title">Register Your Soul</div>
      </div>
      <div class="step-desc">
        Register your SOUL.md hash on-chain. Your agent name will be permanently recorded.
      </div>
      <div class="input-group">
        <label>SOUL.md SHA-256 Hash (0x + 64 hex chars)</label>
        <input type="text" id="input-hash" placeholder="0x..." autocomplete="off" spellcheck="false">
      </div>
      <div class="input-group">
        <label>Agent Name (max 64 characters)</label>
        <input type="text" id="input-name" placeholder="Your agent name" maxlength="64" autocomplete="off" spellcheck="false">
      </div>
      <button class="action-btn btn-register" id="btn-register" disabled>
        Register Soul On-Chain ‚õìÔ∏è
      </button>
    </div>

    <div id="status-msg" class="status"></div>
  </div>

  <!-- Success Screen -->
  <div class="success-box" id="success-box">
    <div class="emoji">üçà‚õìÔ∏è‚úÖ</div>
    <h2>Soul Registered!</h2>
    <p>
      Your SOUL.md hash is now permanently recorded on the Polygon blockchain.<br>
      GuavaGuard ASI Edition is activated.
    </p>
    <a id="tx-link" class="tx-link" href="#" target="_blank" rel="noopener noreferrer"></a>
    <p style="margin-top:16px;">
      Run <code style="color:var(--primary)">guava-guard verify</code> to confirm on-chain verification.
    </p>
  </div>

  <div class="footer">
    <a href="https://polygonscan.com/address/0xecfa4e769050649aeedf727193690a696f65c3fc" target="_blank" rel="noopener noreferrer">SoulRegistry V2 on PolygonScan</a><br>
    Powered by $GUAVA on Polygon ¬∑ Built by <a href="https://note.com/guava_agi" target="_blank" rel="noopener noreferrer">Singularity Laboratory</a>
  </div>
</div>

<script src="ethers.min.js" integrity="sha384-NRAZj94DQk3dgtsOZzVYHbYVV1DFkF5QhL5RRxF0ILZLi6OQ7CsMlun748D42JbO" crossorigin="anonymous"></script>
<script src="activate.js" integrity="sha384-ZL0hIM7KVccWAtiB7zTLgG5lRsLwRf7tO02dmtRsTF8qCtjdis1wpLsvojDHx9nY" crossorigin="anonymous"></script>

</body>
</html>
